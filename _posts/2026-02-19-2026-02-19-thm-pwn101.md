---
layout: post
title: "2026 02 19 thm pwn101"
date: 2026-02-19 15:53:36 +0100
tags: ["tryhackme", "pwn", "binary"]
---

# THM - Pwn101 Writeup
### Target: pwn101 | OS: Arch Linux

## 0x01: Initial Recon
Started with a quick `checksec` to see what I'm dealing with. The binary is **x86-64** and most protections are stripped or disabled.
- **NX is ON:** So no shellcode on the stack.
- **Canary is OFF:** This is the green light for a Buffer Overflow.
- **No PIE:** Memory addresses are static, which makes things way easier.

## 0x02: Looking under the hood (Static)
Threw the binary into **Ghidra**. The `main` function is pretty straightforwardâ€”it takes input using `gets()`. 
As we know, `gets()` is a classic "security sin" because it doesn't care about buffer limits. It'll just keep writing until it hits a newline, perfect for smashing the stack.

## 0x03: Finding the Crash (Dynamic)
I ran the binary inside **GDB-GEF**. I needed to find exactly where the instruction pointer (RIP) gets hijacked.
- Used a cyclic pattern of 100 bytes.
- The app crashed, and GEF told me the **offset is 64** (it might be different on your machine, but for me, 64 was the sweet spot).

## 0x04: The Attack Plan
The goal wasn't just to crash it, but to control it. Since I'm running this on my **Arch** box, I wrote a quick python script using `pwntools` to:
1. Send 64 bytes of junk ('A's).
2. Overwrite the next part of memory to redirect the execution.
3. Pop a shell `/bin/sh`.

## 0x05: Exploit
I keep my exploit code separate for better workflow. 
Check it out here: <a href="https://raw.githubusercontent.com/VayloBat/VayloBat.github.io/main/assets/img/1771514700445_exploitpwn101.py" style="color:#00ff41; font-size:14px; font-family:monospace;">exploitpwn101.py</a>
---

## 0x06: Result:
<img src="https://raw.githubusercontent.com/VayloBat/VayloBat.github.io/main/assets/img/1771515020560_screenshot.png" width="300">
*Got the shell. Game over.*
----

<div style="margin-top:50px; padding:20px; border:1px solid #1a1a1a; border-radius:10px; background:#0a0a0a; display:flex; align-items:center; justify-content:space-between;">
  <div>
    <h4 style="margin:0; color:#ffffff; font-size:1.1em;">Full Writeup & Files</h4>
    <p style="margin:5px 0 0 0; color:#666; font-size:0.9em;">View the exploit code and notes on GitHub.</p>
  </div>
  <a href="https://github.com/VayloBat/My_pwn_journey/tree/main/tryhackme/pwn101" target="_blank" style="text-decoration:none !important;">
    <div style="display:flex; align-items:center; gap:10px; background:#ffffff; color:#000000; padding:10px 20px; border-radius:6px; font-weight:600; font-size:0.9em;" onmouseover="this.style.background='#00FF00'" onmouseout="this.style.background='#ffffff'">
      View on GitHub
    </div>
  </a>
</div>
